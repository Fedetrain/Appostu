import{a as b,b as c,d as v,p as o,u as t,e as w,n as y,s as a,I as N,v as _,x as r,y as k,z as I,a2 as l,H as P,K as z,a4 as L,a5 as s,l as T,a6 as x}from"./index-DQon6D7l.js";const D={class:"div-button"},S={__name:"ProfiloGestore",setup(B){const u=w(),d=b(),f=c(),g=async()=>{L(f).then(()=>{u.replace("/login")}).catch(i=>{})},p=async()=>{try{(await s.requestPermissions()).receive!=="granted"&&(alert("Le notifiche non sono abilitate. Si prega di attivarle dalle impostazioni."),await s.requestPermissions()),await s.register(),s.addListener("pushNotificationReceived",e=>{const n=Math.floor(Date.now()/1e3)+Math.floor(Math.random()*1e3);console.log("Notification received: ",e),s.schedule({notifications:[{id:n,title:e.title,body:e.body,schedule:{at:new Date(Date.now()+1e3)},sound:"default"}]})}),s.addListener("pushNotificationActionPerformed",e=>{console.log("Notification action performed: ",e)}),s.addListener("registration",e=>{console.log("Push registration success, token: ",e.value),h(e.value)})}catch(i){console.error("Errore durante la gestione delle notifiche:",i),alert("Si Ã¨ verificato un errore durante la gestione delle notifiche.")}},h=async i=>{console.log("updatenotification gestore");try{const e=c().currentUser;if(!e){console.log("User not logged in");return}const n=e.uid,m=T(d,"Gestore",n);await x(m,{notificationToken:i},{merge:!0}),console.log("Token updated successfully with merge")}catch(e){console.error("Error updating token: ",e)}};return(i,e)=>(y(),v(t(z),null,{default:o(()=>[a(t(k),null,{default:o(()=>[a(t(N),{color:"primary"},{default:o(()=>[a(t(_),null,{default:o(()=>e[0]||(e[0]=[r("Profilo")])),_:1})]),_:1})]),_:1}),a(t(P),null,{default:o(()=>[I("div",D,[a(t(l),{class:"button","router-link":"/cliente/tabs/tab3/visualizzaProfilo","router-direction":"forward"},{default:o(()=>e[1]||(e[1]=[r(" Visualizza profilo ")])),_:1}),a(t(l),{class:"button-notifiche",onClick:p},{default:o(()=>e[2]||(e[2]=[r(" Attiva notifiche ")])),_:1}),a(t(l),{class:"button-logout",onClick:g},{default:o(()=>e[3]||(e[3]=[r("Logout")])),_:1})])]),_:1})]),_:1}))}};export{S as default};
