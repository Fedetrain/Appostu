import{_ as ae,a as te,b as le,g as F,r as s,o as ie,d as se,p as t,u as o,e as ne,f as re,q as ue,i as de,w as ce,h as ve,m as ge,j as H,k as _,n as me,s as a,I as E,v as O,x as n,t as fe,y as h,z as u,B as pe,C as ze,M as Ne,P as v,a2 as c,H as j,a7 as Ie,R as g,a8 as m,a9 as S,aa as be,G as ye,K as Ce,ab as Me,ac as Ve,ad as we,l as ke,ae as De,a6 as Se}from"./index-DQon6D7l.js";const Ue={class:"div-foto-nome"},Be={class:"image-container"},Pe=["src"],xe={class:"description"},Re={class:"div-button-home"},Le={class:"form-container"},$e={__name:"HomeGestore2",setup(qe){const T=te(),G=le(),A=F(),y=ne(),K=re();let U;const B=s("Clicca per caricare una nuova foto");let P=s(!1);const C=s("Nome del Negozio"),M=s("Città del Negozio"),V=s("Via del Negozio"),w=s("Numero di Cellulare"),x=s("path/immagine.jpg"),k=s("Descrizione del Negozio"),D=s(!0);var f=s("");const R=s(!1),p=s(""),z=s(""),N=s(""),I=s(""),b=s("");let L=null;const J=()=>{R.value=!0,p.value=C.value,z.value=V.value,N.value=M.value,I.value=w.value,b.value=k.value},$=()=>{R.value=!1},Q=async()=>{try{U=await Me.getPhoto({resultType:Ve.Uri,source:we.Photos,quality:90}),L=U.webPath,B.value="Immagine caricata con successo. Premi il pulsante salva"}catch(i){console.error("Errore durante la selezione o il caricamento dell'immagine:",i)}};async function W(i){return new Promise((e,l)=>{try{fetch(i).then(r=>r.blob()).then(r=>e(r)).catch(r=>l(r))}catch(r){l(r)}})}const X=async()=>{P.value=!0;var i;try{const e=ke(T,"Negozi",f.value),l={nomeNegozio:p.value,indirizzoNegozio:z.value,cittaNegozio:N.value,cellulareNegozio:I.value,descrizioneNegozio:b.value};if(L){const r=F(),d=H(r,"/images/".concat(e.id)),q=await W(U.webPath);await De(d,q).then(Te=>{console.log("Immagine caricata con successo per il negozio con ID:",e.id)}),i=await _(d)}await Se(e,l,{merge:!0}),C.value=p.value,V.value=z.value,M.value=N.value,w.value=I.value,k.value=b.value,L&&(x.value=i,B.value="Clicca per caricare una nuova foto"),$(),console.log("Modifiche salvate con successo.")}catch(e){console.error("Errore durante il salvataggio delle modifiche:",e)}finally{P.value=!1}},Y=()=>{y.push("/gestore/tabs/tab1gestore/inserisciServizi")},Z=()=>{y.push("/gestore/tabs/tab1gestore/inserisciferie")},ee=()=>{console.log("Modifica Orari Lavorativi"),y.push("/registrazione/registrazioneClienteGestore/registrazioneNegozio/sceltaOrariLavorativi")};async function oe(){try{const i=G.currentUser;console.log("currentUser",i);let e=ue(de(T,"Negozi"),ce("proprietarioUid","==",i==null?void 0:i.uid));const r=(await ve(e)).docs[0].ref,d=await ge(r);if(d.exists()){f.value=d.id,console.log("id negozio=",f.value),K.dispatch("setIdDocumentNegozioGestore",f.value),C.value=d.data().nomeNegozio||"",M.value=d.data().cittaNegozio||"",V.value=d.data().indirizzoNegozio||"",w.value=d.data().cellulareNegozio||"",k.value=d.data().descrizioneNegozio||"";const q=H(A,"images/".concat(f.value));x.value=await _(q),D.value=!1}else console.log("Nessun negozio trovato per questo utente."),y.push("/registrazione/registrazioneClienteGestore/registrazioneNegozio")}catch(i){console.error("Errore durante il recupero dei dati da Firestore:",i)}}return ie(async()=>{const i=G.currentUser;if(D.value=!0,i)try{console.log("Utente autenticato:",i.uid),await oe(),console.log("Dati caricati con successo da Firestore.")}catch(e){console.error("Errore durante il montaggio del componente:",e)}else console.log("Nessun utente autenticato.");D.value=!1}),(i,e)=>(me(),se(o(Ce),null,{default:t(()=>[a(o(h),null,{default:t(()=>[a(o(E),{color:"primary"},{default:t(()=>[a(o(O),null,{default:t(()=>e[10]||(e[10]=[n("Home")])),_:1}),a(o(fe),{"is-open":o(P),message:"Please wait...",class:"loading-spinner"},null,8,["is-open"])]),_:1})]),_:1}),a(o(j),null,{default:t(()=>[u("div",Ue,[u("div",Be,[u("img",{class:"img",alt:"Silhouette of mountains",src:x.value},null,8,Pe),pe(a(o(Ne),{class:"progress-bar",type:"indeterminate",color:"primary"},null,512),[[ze,D.value]])]),u("h1",null,v(C.value),1),u("h3",null,v(V.value)+", "+v(M.value),1),u("h4",null,v(w.value),1),u("div",xe,[e[11]||(e[11]=u("h6",{class:"h6-description"},"Descrizione",-1)),u("p",null,v(k.value),1)])]),u("div",Re,[a(o(c),{class:"custom-button",fill:"outline",onClick:e[0]||(e[0]=l=>J())},{default:t(()=>e[12]||(e[12]=[n("Modifica informazioni")])),_:1}),a(o(c),{class:"custom-button",fill:"outline",onClick:e[1]||(e[1]=l=>Y())},{default:t(()=>e[13]||(e[13]=[n("Modifica servizi")])),_:1}),a(o(c),{class:"custom-button",fill:"outline",onClick:e[2]||(e[2]=l=>ee())},{default:t(()=>e[14]||(e[14]=[n("Modifica orari lavorativi")])),_:1}),a(o(c),{class:"custom-button",fill:"outline",onClick:e[3]||(e[3]=l=>Z())},{default:t(()=>e[15]||(e[15]=[n("Inserisci ferie")])),_:1})])]),_:1}),a(o(ye),{"is-open":R.value,onIonModalDidDismiss:$},{default:t(()=>[a(o(h),null,{default:t(()=>[a(o(E),{color:"primary"},{default:t(()=>[a(o(O),null,{default:t(()=>e[16]||(e[16]=[n("Modifica informazioni")])),_:1}),a(o(Ie),{slot:"end"},{default:t(()=>[a(o(c),{onClick:$},{default:t(()=>e[17]||(e[17]=[n("Chiudi")])),_:1})]),_:1})]),_:1})]),_:1}),a(o(j),null,{default:t(()=>[u("div",Le,[a(o(g),null,{default:t(()=>[a(o(m),{position:"stacked"},{default:t(()=>e[18]||(e[18]=[n("Immagine del negozio")])),_:1}),a(o(c),{onClick:e[4]||(e[4]=l=>Q())},{default:t(()=>[n(v(B.value),1)]),_:1})]),_:1}),a(o(g),null,{default:t(()=>[a(o(m),{position:"stacked"},{default:t(()=>e[19]||(e[19]=[n("Nome")])),_:1}),a(o(S),{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=l=>p.value=l)},null,8,["modelValue"])]),_:1}),a(o(g),null,{default:t(()=>[a(o(m),{position:"stacked"},{default:t(()=>e[20]||(e[20]=[n("Via")])),_:1}),a(o(S),{modelValue:z.value,"onUpdate:modelValue":e[6]||(e[6]=l=>z.value=l)},null,8,["modelValue"])]),_:1}),a(o(g),null,{default:t(()=>[a(o(m),{position:"stacked"},{default:t(()=>e[21]||(e[21]=[n("Città")])),_:1}),a(o(S),{modelValue:N.value,"onUpdate:modelValue":e[7]||(e[7]=l=>N.value=l)},null,8,["modelValue"])]),_:1}),a(o(g),null,{default:t(()=>[a(o(m),{position:"stacked"},{default:t(()=>e[22]||(e[22]=[n("Numero di cellulare")])),_:1}),a(o(S),{modelValue:I.value,"onUpdate:modelValue":e[8]||(e[8]=l=>I.value=l)},null,8,["modelValue"])]),_:1}),a(o(g),null,{default:t(()=>[a(o(m),{position:"stacked"},{default:t(()=>e[23]||(e[23]=[n("Descrizione")])),_:1}),a(o(be),{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=l=>b.value=l)},null,8,["modelValue"])]),_:1}),a(o(c),{expand:"block",onClick:X},{default:t(()=>e[24]||(e[24]=[n("Salva modifiche")])),_:1})])]),_:1})]),_:1},8,["is-open"])]),_:1}))}},Fe=ae($e,[["__scopeId","data-v-2a2bc712"]]);export{Fe as default};
