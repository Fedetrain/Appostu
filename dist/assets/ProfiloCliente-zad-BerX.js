import{_,a as v,b as c,d as b,p as t,u as e,e as I,n as w,s as a,I as y,v as N,x as n,y as k,z as P,a2 as l,Y as x,a3 as z,H as C,K as L,a4 as T,a5 as i,l as D,a6 as B}from"./index-DQon6D7l.js";const S={class:"div-button"},V={__name:"ProfiloCliente",setup(A){const u=v(),d=I(),f=c(),g=async()=>{try{await T(f),d.replace("/login")}catch(s){console.error("Errore durante il logout:",s)}},p=async()=>{try{(await i.requestPermissions()).receive!=="granted"&&(alert("Le notifiche non sono abilitate. Si prega di attivarle dalle impostazioni."),await i.requestPermissions()),await i.register(),i.addListener("pushNotificationReceived",o=>{const r=Math.floor(Date.now()/1e3)+Math.floor(Math.random()*1e3);console.log("Notification received: ",o),i.schedule({notifications:[{id:r,title:o.title,body:o.body,schedule:{at:new Date(Date.now()+1e3)},sound:"default"}]})}),i.addListener("pushNotificationActionPerformed",o=>{console.log("Notification action performed: ",o)}),i.addListener("registration",o=>{console.log("Push registration success, token: ",o.value),h(o.value)})}catch(s){console.error("Errore durante la gestione delle notifiche:",s),alert("Si Ã¨ verificato un errore durante la gestione delle notifiche.")}},h=async s=>{console.log("updatenotification gestore");try{const o=c().currentUser;if(!o){console.log("User not logged in");return}const r=o.uid,m=D(u,"Gestore",r);await B(m,{notificationToken:s},{merge:!0}),console.log("Token updated successfully with merge")}catch(o){console.error("Error updating token: ",o)}};return(s,o)=>(w(),b(e(L),null,{default:t(()=>[a(e(k),null,{default:t(()=>[a(e(y),{color:"primary"},{default:t(()=>[a(e(N),null,{default:t(()=>o[0]||(o[0]=[n("Profilo")])),_:1})]),_:1})]),_:1}),a(e(C),null,{default:t(()=>[P("div",S,[a(e(l),{class:"button","router-link":"/cliente/tabs/tab3/visualizzaProfilo","router-direction":"forward"},{default:t(()=>o[1]||(o[1]=[n(" Visualizza profilo ")])),_:1}),a(e(l),{class:"button-notifiche",onClick:p},{default:t(()=>o[2]||(o[2]=[n(" Attiva notifiche ")])),_:1}),a(e(l),{class:"button-logout",onClick:g},{default:t(()=>[o[3]||(o[3]=n(" Logout ")),a(e(x),{slot:"end",icon:e(z)},null,8,["icon"])]),_:1})])]),_:1})]),_:1}))}},M=_(V,[["__scopeId","data-v-cf839f91"]]);export{M as default};
